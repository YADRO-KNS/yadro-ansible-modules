---
- name: Test session arguments | Try to create session without username and password
  yadro.obmc.bmc_session:
    connection:
      hostname:       "{{ connection_hostname }}"
      port:           "{{ connection_port }}"
      session_key:    "Some session key"
      timeout:        "{{ connection_timeout }}"
      validate_certs: "{{ connection_validate_certs }}"
    state: "present"
  register: result
  ignore_errors: true

- name: Test session arguments | Check error raised
  assert:
    that:
      - "result.failed == true"
      - "result.changed == false"
      - "result.msg == 'Cannot create session.'"
      - "result.error_info == 'Connection username and password required to create session.'"
